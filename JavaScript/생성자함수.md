# 생성자 함수와 객체 생성

## 생성자 함수란

new 연산자와 함께 호출하여 객체 인스턴스를 생성하는 함수를 말한다. 인스턴스란, 생성자 함수에 의해 생성된 객체이다. 자바스크립트는 아래와 같은 빌트인 생성자 함수를 제공한다.

`Object, String, Number, Boolean, Function, Array, Date, RegExp, Promise`

## 생성자 함수를 사용하는 이유

객체리터럴 방식이 더 간편한데, 왜 생성자 함수를 사용할까?
객체 리터럴에 의해 객체를 생성하는 경우 프로퍼티 구조가 동일해도 매번 같은 프로퍼티와 메서드를 기술해야 한다. 생성자 함수로 객체를 생성하면 클래스로 인스턴스를 생성하듯이 프로퍼티 구조가 동일한 객체 여러 개를 간편하게 생성할 수 있다.

## 생성자 함수의 형식

일반 함수와 동일한 방식으로 정의하고, new 연산자와 함께 호출하면 생성자 함수로서 동작하여 인스턴스를 생성한다. 그래서, 일반 함수와 구분하기 위해서 생성자 함수는 보통 대문자로 시작한다.

## 생성자 함수의 동작 방식

1. new 연산자와 함께 함수를 호출하면 빈 객체를 만들고, this에 할당한다.
   `this = {}`
2. this에 프로퍼티들을 추가한다.
3. this를 반환한다.
   `return this;`

## 함수는 일급 객체

함수는 일반 객체가 가지고 있는 내부 슬롯과 내부 메서드는 물론, 함수로서 동작하기 위해 함수 객체만을 위한 [[Environment]], [[FormalParameters]] 등의 내부 슬롯과 [[Call]], [[Construct]] 같은 내부 메서드를 추가로 가지고 있다.
**함수가 일반 함수로서 호출되면 내부 메서드 [[Call]], new 연산자와 함께 생성자 함수로서 호출되면 내부 메서드 [[Construct]]가 호출된다.**

## constructor와 non-constructor

내부 메서드 [[call]]을 가진 함수 객체를 callable, [[Constructor]]를 가진 함수 객체를 constructor, [[Constructor]]를 갖지 않는 함수 객체를 non-constructor라 한다.

1. callable: 호출할 수 있는 객체(함수)
2. constructor: 생성자 함수로서 호출할 수 있는 함수(선언문, 표현식, class)
3. non-constructor: 객체를 생성자 함수로서 호출할 수 없는 함수(화살표 함수, ES6 메서드 축약표현)

## new 연산자

new 연산자와 함께 함수를 호출하면 일반 함수도 생성자 함수로 동작한다. 함수 객체 내부 메서드 [[Call]]이 아니라, [[Constructor]]가 호출되는 것이다. 단, non-constructor 함수는 생성자 함수로 동작하지 못한다.

## new.target

this와 유사하게 constructor인 모든 함수 내부에서 암묵적인 지역 변수와 같이 사용되며, 메타 프로퍼티라고 부른다. 함수 내부에서 new.target을 사용하면 new 연산자와 함께 생성자 함수로서 호출되었는지 확인할 수 있다. new 연산자와 함께 생성자 함수로서 호출되면 new.target은 함수 자신을 가리킨다. new 연산자 없이 일반 함수로서 호출된 함수 내부의 new.target은 undefined이다. **따라서 함수 내부에서 new.target을 사용하여 new연산자와 생성자 함수로서 호출했는지 확인하여, 그렇지 않은 경우 new 연산자와 함께 재귀 호출을 통해 생성자 함수로서 호출할 수 있다.**
