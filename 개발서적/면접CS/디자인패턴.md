# 디자인 패턴

프로그램을 설계할 때 발생했던 문제들을 객체 간의 상호 관계 등을 이용하여 해결할 수 있도록 하나의 규약 형태로 만들어 놓은 것

## 싱글톤 패턴

하나의 클래스에 하나의 인스턴스를 만들어 이를 기반으로 로직을 만든다. 보통 데이터베이스 연결 모듈에 많이 쓰인다.

- 장점: 하나의 인스턴스를 다른 모듈들이 공유하며 사용하기 때문에 인스턴스 생성 비용이 줄어듦

### 자바스크립트의 싱글톤패턴

간단한 예시로, 리터럴 또는 new Object로 객체를 생성하면 다른 어떤 객체와도 같지 않다.

자바스크립트의 싱글톤패턴 예시

```
class Singletone {
    constructor() {
        if(!Singletone.instance) {
            Singletone.instance = this
        }
    return Singletone.instance
    }

    getInstance() {
        return this.instance
    }
}
const a = new Singletone()
const b = new Singletone()
console.log(a === b) //true
```

Singletone.instance라는 하나의 인스턴스를 가지는 Singletone 클래스. a와 b는 하나의 인스턴스를 가진다.

### 데이터베이스 연결 모듈

```
const URL = 'URL'
const createConnection = url => ({"url" : url})
class DB {
    construnctor(url) {
        if(!DB.instance) {
            DB.instance = createConnection(url)
        }
        return DB.instance
    }
    connect() {
        return this.instance
    }
}

const a = new DB(URL)
const b = new DB(URL)
console.log(a === b) // true
```

DB.instance라는 하나의 인스턴스를 기반으로 a,b를 생성하였다. 이를 통해 데이터베이스 연결에 관한 인스턴스 생성비용을 아낄 수 있다.
</br>
싱글톤 패턴은 Node.js에서 MongoDB 데이터베이스를 연결할 때 Mongoose 모듈에서 볼 수 있다. mongoose의 데이터베이스를 연결할 때 쓰는 connect() 함수는 싱글톤 인스턴스를 반환한다. Node.js에서 MySQL데이터베이스를 연결할 때도 싱글톤 패턴이 쓰인다.

## 싱글톤 패턴의 단점

TDD(Test Driven Development)
TDD를 할 때 단위 테스트를 주로 하는데, 단위 테스트는 테스트가 서로 독립적이어야 하며 테스트를 어떤 순서로든 실행할 수 있어야 하는데 싱글톤 패턴은 미리 생성된 하나의 인스턴스를 기반으로 구현하는 패턴이므로 각 테스트마다 '독립적인' 인스턴스를 만들기가 어렵다.2
